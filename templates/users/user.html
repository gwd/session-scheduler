{{define "user/link"}}
<a href="/uid/user/{{.ID}}/view">{{.Username}}</a>
{{end}}

{{define "user/item-full"}}
<div class="container flex-column">
  <h5>{{template "user/link" .}}</h5>
  {{if .Profile}}
    {{if .Profile.RealName}}
    <div>Name: {{.Profile.RealName}}</div>
    {{end}}
    {{if .Profile.Email}}
    <div>Email: {{.Profile.Email}}</div>
    {{end}}
    {{if .Profile.Company}}
    <div>Company: {{.Profile.Company}}</div>
    {{end}}
    {{if .Description}}
    <div>Description: {{.Description}}</div>
    {{end}}
  {{else}}
    <div class="text-muted">Full profile information only available when logged in</div>
  {{end}}
</div>
{{end}}

{{define "user/item-short"}}
<div class="container">
  <div class="row">
    <div class="col-sm"><h5>{{template "user/link" .}}</h5></div>
    <div class="col-sm">{{if .Profile}}{{if .Profile.RealName}}{{.Profile.RealName}}{{end}}{{end}}</div>
    <div class="col-sm">{{if .Profile}}{{if .Profile.Company}}{{.Profile.Company}}{{end}}{{end}}</div>
  </div>
</div>
{{end}}

{{define "user/view"}}
<div class="row">
  <div class="col-9 col-offset-3">
      {{template "user/item-full" .Display}}
    {{if .Display.MayEdit}}
    <a href="edit" class="btn btn-primary" role="button">Edit</a>
    {{end}}
    {{$redirectURL := printf "/uid/user/%s/view" .Display.ID}}
    {{template "discussion/list" dict "List" .Display.List "redirectURL" $redirectURL "CurrentUser" .CurrentUser}}
  </div>
</div>
{{end}}

{{define "user/list"}}
<ul class="list-group">
  {{range .List}}
  <li class="list-group-item">{{template "user/item-short" .}}</li>
  {{else}}
  <p>No users registered yet</p>
  {{end}}
</ul> 
{{end}}

{{define "user/profile/form"}}
		<h4>Profile information (optional)</h4>
		
		<p><details class="text-muted"><summary>How is this used?</summary>The
		following information is optional.  It will be
		displayed publicly along with your username on the
		website, to help people connect with you at the
		conference.  It will be archived with the schedule for
		future reference.</details></p>

		<div class="form-group">
		  <label for="newName">Name</label>
		  <input type="text" name="RealName" id="newName" value ="{{.RealName}}" class="form-control" placeholder="e.g., John Smith">
		</div>
		<div class="form-group">
			<label for="newCompany">Company</label>
			<input type="text" name="Company" value="{{.Company}}" id="newCompany" class="form-control" placeholder="XYZ Corporation, Ltd">
		</div>
		<div class="form-group">
			<label for="newEmail">Email</label>
			<input type="email" name="Email" value="{{.Email}}" id="newEmail" class="form-control" placeholder="name@example.com">
		</div>
		<div class="form-group">
			<label for="newDescription">Description</label>
			<textarea name="Description" id="newProfile" class="form-control"
		         placeholder="Breifly describe who you are, what you do, and what you're looking for from the conference">{{.Description}}</textarea>
		</div>

{{end}}

{{define "user/edit"}}
<div class="row">
	<div class="col-md-6 col-md-offset-3">
		<h1>Editing user {{.Display.Username}}</h1>
		{{with .Error}}
		<div class="alert error">
			{{.}}
		</div>
		{{end}}
		<form action="edit" method="POST">
			<h4>Change Password <small>optional</small></h4>
			<div class="form-group">
				<label for="currentPassword">Current Password</label>
				<input type="password" name="currentPassword" id="currentPassword" class="form-control">
			</div>
			<div class="form-group">
				<label for="newPassword">New Password</label>
				<input type="password" name="newPassword" id="newPassword" class="form-control">
			</div>
			{{template "user/profile/form" .Display.Profile}}
			<input type="submit" value="Save" class="btn btn-primary">
		</form>
	</div>
</div>
{{end}}


{{define "user/new"}}
<div class="col-md-6 col-md-offset-3">
  <h1>Sign Up</h1>
  {{if .Error}}
    <p class="text-danger">
    {{.Error}}
    </p>
  {{end}}
  <form action="/register" method="POST">
    <div class="form-group">
      <label for="newUsername">Username</label> (Required)
      <input type="text" name="Username" value="{{.User.Username}}" id="newUsername" class="form-control">
    </div>
    <div class="form-group">
      <label for="newPassword">Password</label>
      <input type="password" name="Password" id="newPassword" class="form-control">
    </div>
    <div class="form-group">
      <label for="vcode">Verification Code</label>
      <input type="text" name="Vcode" id="vcode" class="form-control">
      <p class="text-muted">Please contact lars dot kurth at citrix dot com if you haven't received a verification code</p>
    </div>
    {{template "user/profile/form" .User.Profile}}
    <input type="submit" value="Register" class="btn btn-primary">
  </form>
</div>
{{end}}
